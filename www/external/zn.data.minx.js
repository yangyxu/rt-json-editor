!function(a){var b=Array.prototype,c=b.push,d=b.sort,e=b.join,f=b.slice,g=b.splice,h=b.indexOf,i=b.lastIndexOf,j=b.forEach,k=function(b){if(a.is(b,l))return b.toArray();if(a.is(b,"array"))return b.slice(0);var c=[];return a.each(b,function(a){c.push(a)}),c},l=a.Class("zn.data.List",{properties:{count:{get:function(){return this.length},set:function(){throw new Error("Unable to set count of List")}}},methods:{init:{auto:!0,value:function(a){this.length=0,this.insertRange(a,0)}},unique:function(){},dispose:function(){this.clear()},add:function(a){var b=this.length;return c.call(this,a),b},addRange:function(a){return this.insertRange(a,this.length)},remove:function(a){var b=this.indexOf(a);return b>=0?(g.call(this,b,1),b):-1},removeAt:function(a){return g.call(this,a,1)[0]},insert:function(a,b){return g.call(this,b,0,a),a},insertRange:function(a,b){return g.apply(this,[b,0].concat(k(a))),b},clear:function(){return g.call(this,0)},getItem:function(a){if(a<this.length)return this[a];throw new Error("Index out of range.")},setItem:function(a,b){if(!(a<this.length))throw new Error("Index out of range.");this[a]=b},getRange:function(a,b){return new l(f.call(this,a,a+b))},indexOf:function(a){return h.call(this,a)},lastIndexOf:function(a){return i.call(this,a)},contains:function(a){return this.indexOf(a)>=0},toggle:function(a){this.contains(a)?this.remove(a):this.add(a)},sort:function(a){return d.call(this,a)},each:function(a,b){j.call(this,a,b)},toArray:function(){return f.call(this,0)},join:function(){return e.call(this)}}})}(zn),function(a){a.Class("zn.data.TList",{statics:{getInstance:function(a){return new this(a)}},properties:{min:0,max:100,TClass:null,TClassArgv:{}},methods:{init:function(a){this.sets(a),this.reset()},reset:function(){this._data=[];for(var a=0;a<(this.min||0);a++)this.push(this.TClassArgv)},push:function(a){if(this.TClass){var b=new this.TClass(a||this.TClassArgv);return this._data.push(b),b}},findOneT:function(b){var c=null,d=b||a.idle;return a.each(this._data,function(a,b){return d(a,b)?(c=a,-1):void 0}),c},findAllT:function(b){var c=[],d=b||a.idle;return a.each(this._data,function(a,b){d(a,b)&&c.push(a)}),c}}})}(zn),function(a){a.Class("zn.data.Task",{statics:{getInstance:function(a){return new this(a)},PANDING:0,WAITING:1,DOING:2,DONE:3},properties:{statue:0},methods:{init:function(a){this.sets(a)}}})}(zn),function(a){var b=a.Class("zn.data.Observable",{properties:{},methods:{init:{auto:!0,value:function(){this.__watchers__={}}},dispose:function(){a.each(this.__watchers__,function(a,b){this.__unbind(b,this.get(b))},this),this.__watchers__=null},watch:function(b,c,d){var e="*"===b?this.constructor._properties_:a.is(b,"array")?b:[b];return e.forEach(function(a){this.__watch(a,c,d)},this),this},unwatch:function(b,c,d){var e="*"===b?this.constructor._properties_:a.is(b,"array")?b:[b];return e.forEach(function(a){this.__unwatch(a,c,d)},this),this},notify:function(b){var c="*"===b?Object.keys(this.__watchers__):a.is(b,"array")?b:[b];return a.each(c,function(a){this.__notify(a)},this),this},__watch:function(a,c,d){var e=a.indexOf("."),f=a,g="",h=this.__watchers__;if(e>=0){f=a.slice(0,e),g=a.slice(e+1);var i=this.get(f);i&&i.watch&&i.watch(g,c,d)}var j=h[f]=h[f]||[];j.push({handler:c,context:d,fullPath:a,subPath:g});var k=this.member(f);if(k&&"property"===k.type){var l=k.meta;if(!l.watched){var m=k.getter,n=k.setter;b.defineProperty(f,{get:function(a){return m.call(this,a)},set:function(a,b){var c=m.call(this);(c!==a||b&&b.force)&&(this.__unbind(f,c),n.call(this,a,b)!==!1&&(this.__bind(f,a),this.notify(f)))},watched:!0},this)}}},__unwatch:function(a,b,c){var d=a.indexOf("."),e=a,f="",g=this.__watchers__;if(d>=0){e=a.slice(0,d),f=a.slice(d+1);var h=this.get(e);h&&h.unwatch&&h.unwatch(f,b,c)}var i,j=g[e];if(!j)return!1;if(b){for(var k=0,l=j.length;l>k;k++)if(i=j[k],i.handler===b&&i.context===c){j.splice(k,1);break}}else j.length=0},__bind:function(b,c){c&&c.watch&&a.each(this.__watchers__[b],function(a){a.subPath&&c.watch(a.subPath,a.handler,a.context)})},__unbind:function(b,c){c&&c.unwatch&&a.each(this.__watchers__[b],function(a){a.subPath&&c.unwatch(a.subPath,a.handler,a.context)})},__notify:function(b){var c=this.get(b);a.each(this.__watchers__[b],function(b){b&&b.handler&&b.handler.call(b.context,a.path(c,b.subPath),b.fullPath,this)},this)}}})}(zn),function(a){var b=a.Class({properties:{direction:{value:"oneway",readonly:!0},target:{value:null,readonly:!0},targetPath:{value:"",readonly:!0},source:{get:function(a){return a?this._owner:this._source},set:function(a){this._source=a,this.__rebind()}},sourcePaths:{get:function(){return this._sourcePaths},set:function(a){this._sourcePaths=this.__parseSourcePaths(a,function(a){a&&this.__rebind()}.bind(this))}},owner:{get:function(){return this._owner}},converter:{value:null},async:{value:!1}},methods:{init:function(b,c,d){{var e=d||{},f=b.member(c);f&&f.meta.binding||{}}a.overwrite(e,{direction:"oneway",converter:{}});var g=this._direction=e.direction;this._source=e.source,this._sourcePaths=this.__parseSourcePaths(e.sourcePaths),this._owner=e.owner||b,this._converter=this.__parseConverter(e),this._target=b,this._targetPath=c,("twoway"===g||"oneway"===g)&&this.__rebind(),("twoway"===g||"inverse"===g)&&b.watch(c,function(a){this.__updateSource(a)},this)},dispose:function(){this._source=null,this.__rebind()},__updateSource:function(b){var c=this._converter,d=null;return a.each(this.sourcePaths,function(e){d=c.revert.call(c.context,b),a.path(this.get("source",e[0]),e[1],d)},this),this},__updateTarget:function(){var b=this,c=[],d=null,e=this._owner,f=this._target,g=null,h=this._targetPath,i=this._converter;return a.each(this.sourcePaths,function(f){d=a.path(b.get("source",f[0]),f[1]),d=a.is(d,"function")?d.bind(e):d,c.push(d)}),g=i.convert.apply(i.context,c),f.set(h,g),this},__rebind:function(){var b=this._sourcePaths,c=this._watchers;return c&&(a.each(c,function(a){a.source.unwatch(a.path,a.handler)}),this._watchers=null),a.each(b,function(b){var d=b[0],e=b[1],f=this.get("source",d);a.can(f,"watch")&&(f.watch(e,this.__updateTarget.bind(this)),c=c||[],c.push({source:f,path:e,handler:this.__updateTarget}))},this),this.__updateTarget()},__parseSourcePaths:function(a,b){for(var c=a.split(","),d="",e=!1,f=0,g=c.length;g>f;f++)d=c[f].trim(),"#"===d.charAt(0)&&(d=d.substring(1),e=!0),c[f]=[e,d],b&&b(e,d);return c},__parseConverter:function(b){var c=b.converter;(a.is(c,"string")||a.is(c,"function"))&&(c={convert:c});var d=c.convert=b.convert||c.convert||function(a){return a};if(c.revert=b.revert||function(a){return a},c.context=b.context||this.owner,a.is(d,"string")){var e=d.lastIndexOf("."),f=d,g=this.source||this.owner,h="";e>0&&(h=d.slice(0,e),f=d.slice(e+1),g=a.path(this.source,h)),d=g&&g[f]}return c.convert=d,c}}}),c=a.Class("zn.data.Bindable",a.data.Observable,{statics:{parseOptions:function(b,c){var d=null;if("string"==typeof b&&"{"===b.charAt(0)&&"}"===b.charAt(b.length-1)){var e=b.slice(1,-1),f=e.split(";");d={owner:c,sourcePaths:f.shift()},a.each(f,function(a){if(!a)return-1;var b=a.split("=");d[b[0]]=b[1]})}else"object"==typeof b&&(d=b);return d}},properties:{model:{get:function(){return this._model},set:function(b){this._model=b,a.each(this.__bindings__,function(a){a.set("source",b)})}}},methods:{init:{auto:!0,value:function(){this.__bindings__={}},after:function(){this.__binding()}},dispose:function(){this.super(),a.each(this.__bindings__,function(a){a.dispose()}),this.__bindings__=null},let:function(a,b,d,e){var f=c.parseOptions(b);f?(f.owner=d,this.setBinding(a,f,e)):this.set(a,b)},getBinding:function(a){return this.__bindings__[a]},setBinding:function(a,c,d){return c.source=c.model||this.get("model"),c.owner=c.owner||this,this.clearBinding(a),this.__bindings__[a]=new b(d||this,c.targetPath||a,c),this},clearBinding:function(a){var b=this.__bindings__[a];b&&(b.dispose(),delete this.__bindings__[a])},__binding:function(){var b=this,c=this.constructor.getMeta("properties");a.each(c,function(a,c){a&&a.binding&&b.let(c,a.binding)})}}})}(zn),function(a){a.Class("zn.data.Map",{properties:{count:{get:function(){var a=0;return this.each(function(){a++}),a}},keys:{get:function(){return Object.keys(this._map)},set:function(){throw new Error("Unable to set keys of Map")}},values:{get:function(){return this.__getMapValues()},set:function(){throw new Error("Unable to set values of Map")}}},methods:{init:{auto:!0,value:function(a){this._map={},this.concat(a)}},concat:function(b){if(b){var c=(this._map,this);a.each(b,function(a,b){c.set(b,a)})}return this},contains:function(a){return a in this._map},getItem:function(a){return this._map[a]},get:function(a){if(this.has(a))return this.super(a);var b=this.getItem(a);return b&&b.value},set:function(a,b){if(this.has(a))return this.super(a);var c=a,d=this._map[c];return d||(d=this._map[c]={key:c}),d.value=b,this},remove:function(a){return delete this._map[a],this},clear:function(){return this._map={},this},each:function(b,c){return a.each(this._map,b,c),this},eachKey:function(b,c){return a.each(this.keys,b,c),this},eachValue:function(b,c){return a.each(this.values,b,c),this},toArray:function(){var a=[];return this.each(function(b){a.push(b)}),a},toObject:function(){var a={};return this.each(function(b){a[b.key]=b.value}),a},__getMapValues:function(){var a=[];return this.each(function(b){a.push(b.value)}),a}}})}(zn),function(a){a.Class("zn.data.ObservableList",a.data.List,{mixins:[a.data.Observable],events:["change"],methods:{add:function(a){var b=this.super(a);return this.notify("count"),this.fire("change",{action:"add",items:[a],index:b}),b},addRange:function(a){var b=this.super(a);return this.notify("count"),this.fire("change",{action:"add",items:a,index:b}),b},insert:function(a,b){return this.super(a,b),this.notify("count"),this.fire("change",{action:"add",items:[a],index:b}),b},insertRange:function(a,b){return this.super(a,b),this.notify("count"),this.fire("change",{action:"add",items:a,index:b}),b},remove:function(a){var b=this.super(a);return b>=0&&(this.notify("count"),this.fire("change",{action:"remove",items:[a],index:b})),index},removeAt:function(a){var b=this.super(a);return void 0!==b&&(this.notify("count"),this.fire("change",{action:"remove",items:[b],index:a})),b},clear:function(){var a=this.super();return this.notify("count"),this.fire("change",{action:"clear",items:a}),a},sort:function(a){var b=this.super(a);return this.notify("count"),this.fire("change",{action:"sort",sort:a||function(a,b){return a>b?1:b>a?-1:0}}),b}}})}(zn),function(a){a.Class("zn.data.ObservableMap",a.data.Map,{mixins:[a.data.Observable],events:["change"],methods:{set:function(a,b){if(this.has(a))return this.super(a);var c=this._map,d={key:a,value:b};if(a in c){var e=c[a];c[a]=d,this.fire("change",{action:"replace",oldItem:e,newItem:d})}else c[a]=d,this.notify("count"),this.fire("change",{action:"add",items:[d]})},remove:function(a){var b=this._map;if(a in b){var c=b[a];delete b[a],this.notify("count"),this.fire("change",{action:"remove",items:[c]})}},clear:function(){this.toArray();return this.super(),this.notify("count"),this.fire("change",{action:"clear",items:this.toArray()}),this}}})}(zn);